<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="web.css"/>

    <title>Emergency News and Statistics</title>
</head>
<body>
<header>
    <h1>Emergency News and Statistics</h1>
</header>

<div class="grid-container">

    <div class="grid-item">
        <h2>UK COVID-19 Statistics</h2>
        <canvas id="covidCasesChart"></canvas>
        <br>
        <br>
        <p>At the beginning of 2022, many parts of the world experienced a surge in COVID-19 cases. January and February
            were particularly challenging months, as the highly infectious Omicron variant of the virus spread rapidly,
            leading to a sharp increase in the number of new infections. Hospitals became overwhelmed with patients, and
            governments had to implement strict measures to slow the spread of the virus. However, as more people became
            vaccinated and booster shots were rolled out, the number of cases gradually began to decrease. By late
            February, many countries saw a significant drop in daily case numbers, giving some hope that the worst of
            the pandemic may be over. Nonetheless, the situation remains unpredictable, and people are still being
            encouraged to take all necessary precautions to protect themselves and others.</p>
    </div>

    <div class="grid-item">
        <h2>Finances</h2>
        <div class="inflationChart-container">
            <canvas id="inflationChart"></canvas>
        </div>
        <p>Inflation has become a major concern for many industries in the UK, as rising prices for goods and services
            continue to eat into profits and create economic uncertainty. A combination of factors, including supply
            chain disruptions, labor shortages, and increased demand for goods, have contributed to the inflationary
            pressures. This has impacted a wide range of industries, from hospitality and tourism to manufacturing and
            retail. Companies are having to pay higher prices for raw materials, transport, and other essential inputs,
            which in turn leads to higher prices for consumers. Some businesses have had to absorb these costs, while
            others have passed them onto customers in the form of price increases. As a result, many consumers are
            feeling the pinch, and the government is under pressure to take action to address the issue.</p>
    </div>

    <div class="grid-item">
        <div class="status-container">
            <ul id="terrorism-section">
                <!--Dynamically generated by server / jquery            -->
            </ul>
        </div>

        <div class="weather-alert">
            <div class="status-container">
                <ul id="weather-section">
                    <!--Dynamically generated by server / jquery            -->
                </ul>
            </div>
        </div>
    </div>

    <div class="grid-item">
        <h2>Crime Statistics in Cardiff</h2>
        <canvas id="crimeChart"></canvas>
    </div>

    <div class="grid-item">
        <h2>Breaking News</h2>
        <ul id="articles-section">
            <!--Dynamically generated by server / jquery            -->
        </ul>
    </div>
</div>


<script>

    $(document).ready(function () {

        $.get("http://localhost:8080/articles", function (data) {
            for (let i = 0; i < data.length; i++) {
                var article = data[i];
                var headline = article.headline;
                var body = article.body;
                var date = article.dateTime;

                $('#articles-section').append('<li>' +
                    '<img src="https://via.placeholder.com/100x100" alt="Headline 3">' +
                    '<h1>' + headline + '</h1>' +
                    '<p>' + body + '</p>' +
                    '<time>' + date + '</time>' +
                    '</li>\n'
                );
            }
        });

        //THREAT GET REQUEST
        $.get("http://localhost:8080/threats/query?type=terror&level=Low", function (data) {
            for (let i = 0; i < data.length; i++) {
                var threat = data[i];
                var type = threat.type
                var colour = threat.colour
                var level = threat.level
                var description = threat.description

                $('#terrorism-section').append('<li>' +
                    '<h2>' + type + '</h2>' +
                    '<div ' + 'class="' + colour + '">' + level + '</div>' +
                    '<br>' +
                    '<p>' + description + '</p>' +
                    '</li>\n'
                );
            }
        });

        $.get("http://localhost:8080/threats/query?type=weather&level=High", function (data) {
            for (let i = 0; i < data.length; i++) {
                var threat = data[i];
                var type = threat.type
                var colour = threat.colour
                var level = threat.level
                var description = threat.description

                $('#weather-section').append('<li>' +
                    '<h2>' + type + '</h2>' +
                    '<div ' + 'class="' + colour + '">' + level + '</div>' +
                    '<br>' +
                    '<p>' + description + '</p>' +
                    '</li>\n'
                );
            }
        });

        $.get("http://localhost:8080/crime/graph", function (data) {
            var ctx = document.getElementById('crimeChart').getContext('2d');
            var crimeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Cases of crime (100s)',
                        data: data.data,
                        backgroundColor: 'rgba(0, 188, 212, 0.2)',
                        borderColor: 'rgba(0, 188, 212, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        });

        const data = {
            labels: ['Housing & Bills', 'Food & Drinks', 'Health', 'Alcohol & Tobacco', 'Clothing'],
            datasets: [{
                label: '(%) Increase: ',
                data: [25, 17, 6, 5, 6],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(255, 206, 86, 0.5)',
                    'rgba(75, 192, 192, 0.5)',
                    'rgba(153, 102, 255, 0.5)'
                ],
                borderColor: [
                    'rgb(255, 99, 132)',
                    'rgb(54, 162, 235)',
                    'rgb(255, 206, 86)',
                    'rgb(75, 192, 192)',
                    'rgb(153, 102, 255)'
                ],
                borderWidth: 1
            }]
        };

        const options = {
            plugins: {
                title: {
                    display: true,
                    text: 'Industrial Inflation (%)'
                }
            }

        };

        const inflationChart = new Chart(document.getElementById('inflationChart'), {
            type: 'doughnut',
            data: data,
            options: options
        });


        $.get("http://localhost:8080/covid/graph", function (data) {
            var ctx = document.getElementById('covidCasesChart').getContext('2d');
            var covidCasesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Number of Cases 2022',
                        data: data.data,
                        backgroundColor: 'rgba(0, 188, 212, 0.2)',
                        borderColor: 'rgba(0, 188, 212, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        });
    });

</script>
</body>
</html>